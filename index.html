<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Multiscale Finite Element Complex (MsFEC): A Multiscale Differential Complex - Short Mathematical Problem Description</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="my_custom_doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="icon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Multiscale Finite Element Complex (MsFEC)
   &#160;<span id="projectnumber">v1.2</span>
   </div>
   <div id="projectbrief">Parallel C++ Implementation of a 3D multiscale FE complex.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">A Multiscale Differential Complex - Short Mathematical Problem Description </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#sec1">The de Rham Complex with Rough Weighting</a></li>
<li class="level1"><a href="#sec2">The Hodge-Laplace Problem with Rough Coeffients</a></li>
<li class="level1"><a href="#sec3">Notes about the Code</a><ul><li class="level2"><a href="#sec31">Parameter Files</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="sec1"></a>
The de Rham Complex with Rough Weighting</h1>
<p>The purpose of this work is to introduce a unifiying framework for the construction of stable pairings of conforming multiscale finite elements in all spaces across the \(L^2\)-Hilbert complex</p>
<p class="formulaDsp">
\begin{eqnarray} 0 \stackrel{}{\rightarrow} L^2\Lambda^0(\Omega,A_{\varepsilon, 0}) \stackrel{\nabla}{\longrightarrow} L^2\Lambda^1(\Omega,A_{\varepsilon, 1}) \stackrel{\nabla\times}{\longrightarrow} L^2\Lambda^2(\Omega,A_{\varepsilon, 2}) \stackrel{\nabla\cdot}{\longrightarrow} L^2\Lambda^3(\Omega,A_{\varepsilon, 3}) \stackrel{}{\rightarrow} 0 \end{eqnarray}
</p>
<p>whose domain complex is a modified \(L^2\)-de Rham complex.</p>
<p class="formulaDsp">
\begin{eqnarray} 0 \stackrel{}{\rightarrow} H(\mathrm{grad}, \Omega, A_{\varepsilon, 0}) \stackrel{\nabla}{\longrightarrow} H(\mathrm{curl}, \Omega, A_{\varepsilon, 1}) \stackrel{\nabla\times}{\longrightarrow} H(\mathrm{div}, \Omega, A_{\varepsilon, 2}) \stackrel{\nabla\cdot}{\longrightarrow} L^2(\Omega, A_{\varepsilon, 3}) \stackrel{}{\rightarrow} 0 \end{eqnarray}
</p>
<p>for the Hodge-Laplace equation when weighted with rough coefficients.</p>
<p>This amouts to either solving scalar Laplace equations with rough coefficients in standard or mixed form or to solving vector valued Laplace equations in mixed form in spaces whose scalar procucts are weighted with rough positive coefficient functions. The latter seeks an (orthogonal) Helmholtz-Hodge decomposition (generalized Helmholtz decomposition) into threee types of functions: curl-free fields, divergence-free fields and so called hamonic forms with different boundary conditions dependent on the auxiliary variable chosen.</p>
<h1><a class="anchor" id="sec2"></a>
The Hodge-Laplace Problem with Rough Coeffients</h1>
<p>We consider a modified Hodge-Laplace equation on the unit square \(\Omega = [0,1]^3 \):</p>
<p class="formulaDsp">
\begin{eqnarray} \mathrm{d}(A_{\varepsilon ,k+1}^{-1} \mathrm{d}^\ast)u_k + \mathrm{d}^\ast(A_{\varepsilon, k+1} \mathrm{d})u_k = f_k - P_{\mathfrak{h}^k} \end{eqnarray}
</p>
<p>for positive coefficients \(A_\varepsilon^k\) and \(k=0,\dots ,3\).</p>
<p>In 3D this essentially amounts in two different equation - a scalar one and a vectorial one. The scalar case reads</p>
<p class="formulaDsp">
\begin{eqnarray} \nabla\cdot(A_\varepsilon \nabla u) = f - P_\mathfrak{h} \end{eqnarray}
</p>
<p>and the vector case reads</p>
<p class="formulaDsp">
\begin{eqnarray*} \nabla\times(A_\varepsilon \nabla\times u) + \nabla(B_\varepsilon \nabla\cdot u) = f - P_\mathfrak{h} \end{eqnarray*}
</p>
<p>apart from possibly switching the roles of the coeffcients.</p>
<dl class="section note"><dt>Note</dt><dd>We solve the equation on prototypically on the unit cube. Although more complicated domains are easily possible we do not take into account harmonic forms for the vector Laplacian. That means that the 3D domains should not have voids or handles. This will be changed in the future.</dd></dl>
<p>Our method describes a stable multiscale discretization for relatively coarse meshes, i.e., we generate bounded projections such that the diagram </p><p class="formulaDsp">
\begin{eqnarray*} \newcommand{\ra}[1]{\kern-1.5ex\xrightarrow{\ \ #1\ \ }\phantom{}\kern-1.5ex} \newcommand{\ras}[1]{\kern-1.5ex\xrightarrow{\ \ \smash{#1}\ \ }\phantom{}\kern-1.5ex} \newcommand{\da}[1]{\bigg\downarrow\raise.5ex\rlap{\scriptstyle#1}} \begin{array}{ccccccc} H(\mathrm{grad}, \Omega, A_{\varepsilon, 0}) &amp; \ra{\nabla} &amp; H(\mathrm{curl}, \Omega, A_{\varepsilon, 1}) &amp; \ra{\nabla\times} &amp; H(\mathrm{div}, \Omega, A_{\varepsilon, 2}) &amp; \ra{\nabla\cdot} &amp; L^2(\Omega, A_{\varepsilon, 3}) \\ \da{\Pi_{\textsf{ms}}^{\mathsf{grad}}} &amp; &amp; \da{\Pi_{\textsf{ms}}^{\mathsf{curl}}} &amp; &amp; \da{\Pi_{\textsf{ms}}^ {\mathsf{div}}} &amp; &amp; \da{\Pi_{\textsf{ms}}^{L^2}} \\ \mathcal{Q}^{\textsf{ms}} &amp; \ras{\nabla} &amp; \mathcal{Ned}^{\textsf{ms}} &amp; \ras{\nabla\times} &amp; \mathcal{RT}^{\textsf{ms}} &amp; \ras{\nabla\cdot} &amp; \mathcal{DQ}^{\textsf{ms}} \\ \end{array} \end{eqnarray*}
</p>
<p> commutes. That means that is discrete sequence is a subcomplex of the original one.</p>
<h1><a class="anchor" id="sec3"></a>
Notes about the Code</h1>
<p>The code is </p><ul>
<li>
implemented in 3D using the deal.ii library </li>
<li>
MPI parallel and can be used on clusters (grids and solvers are parallelized) </li>
<li>
documented using doxygen </li>
<li>
mathematically documented in an upcoming paper </li>
<li>
available under a LPGL license (see license, note that other parts have different licenses) </li>
</ul>
<h2><a class="anchor" id="sec31"></a>
Parameter Files</h2>
<p>The code produces one executable to solve the Hodge-Laplcae problem for each segment of the complex described above. Each executable takes as an input a parameter file containing information about the problems to be solved devided in three sections </p><ol>
<li>
Paramters for the standard method (for a comparison) </li>
<li>
Paramters for the multiscale method </li>
<li>
Paramters for the equation data </li>
</ol>
<p>sample paramter files are provided in the <code>example_parameters/</code> subfolder of the code directory.</p>
<p>If you, for example, want to solve the multiscale Hodge-Laplace problem for 2-forms (i.e., with modified Nedelec-Raviart-Thomas element pairings) you need to call </p><div class="fragment"><div class="line">../your_build_dir&gt; mpirun -n N source/MsFEC_Ned_RT -p my_paramter_file.in</div></div><!-- fragment --><p>An example parameter file can look like </p><div class="fragment"><div class="line"><span class="preprocessor"># Example parameter file &quot;my_paramter_file.in&quot;</span></div><div class="line"></div><div class="line">subsection Standard method parameters</div><div class="line">    subsection Mesh</div><div class="line"><span class="preprocessor">        # number of global refinements </span></div><div class="line">        <span class="keyword">set</span> refinements = 6</div><div class="line">    end</div><div class="line">  </div><div class="line">    subsection Control flow</div><div class="line"><span class="preprocessor">        # compute flag for standard solution</span></div><div class="line">        <span class="keyword">set</span> compute solution = <span class="keyword">true</span></div><div class="line">      </div><div class="line"><span class="preprocessor">        # verbose</span></div><div class="line">        <span class="keyword">set</span> verbose = <span class="keyword">true</span></div><div class="line">      </div><div class="line"><span class="preprocessor">        # what solver to use</span></div><div class="line">        <span class="keyword">set</span> use direct solver = <span class="keyword">false</span></div><div class="line">      </div><div class="line"><span class="preprocessor">        # renumbering to reduce bandwidth</span></div><div class="line">        <span class="keyword">set</span> dof renumbering = <span class="keyword">false</span></div><div class="line">    end</div><div class="line">    </div><div class="line"><span class="preprocessor">    # name of outputfile without ending</span></div><div class="line">    <span class="keyword">set</span> filename output = test-01_NED-RT-Std</div><div class="line">    </div><div class="line"><span class="preprocessor">    # name of outputfile without ending</span></div><div class="line">    <span class="keyword">set</span> dirname output = data_test-01_NED-RT</div><div class="line">    </div><div class="line"><span class="preprocessor">    # compare to manufactured exact solution u=Ax+b</span></div><div class="line">    <span class="keyword">set</span> use exact solution = <span class="keyword">false</span></div><div class="line">end</div><div class="line"></div><div class="line"></div><div class="line">subsection Multiscale method parameters</div><div class="line">    subsection Mesh</div><div class="line">        <span class="keyword">set</span> global refinements = 2</div><div class="line">        <span class="keyword">set</span> local refinements = 4</div><div class="line">    end</div><div class="line">  </div><div class="line">    subsection Control flow</div><div class="line"><span class="preprocessor">        # compute flag</span></div><div class="line">        <span class="keyword">set</span> compute solution = <span class="keyword">true</span></div><div class="line">      </div><div class="line"><span class="preprocessor">        # verbose</span></div><div class="line">        <span class="keyword">set</span> verbose = <span class="keyword">true</span></div><div class="line">        <span class="keyword">set</span> verbose basis = <span class="keyword">false</span></div><div class="line">      </div><div class="line"><span class="preprocessor">        # what solver to use</span></div><div class="line">        <span class="keyword">set</span> use direct solver = <span class="keyword">false</span></div><div class="line">        <span class="keyword">set</span> use direct solver basis = <span class="keyword">false</span></div><div class="line">      </div><div class="line"><span class="preprocessor">        # renumbering to reduce bandwidth</span></div><div class="line">        <span class="keyword">set</span> dof renumbering = <span class="keyword">false</span></div><div class="line">        </div><div class="line"><span class="preprocessor">        # write first basis</span></div><div class="line">        <span class="keyword">set</span> write first basis = <span class="keyword">true</span> </div><div class="line">    end</div><div class="line">    </div><div class="line"><span class="preprocessor">    # name of outputfile without ending</span></div><div class="line">    <span class="keyword">set</span> filename output = test-01_NED-RT-Ms</div><div class="line">    </div><div class="line"><span class="preprocessor">    # name of outputfile without ending</span></div><div class="line">    <span class="keyword">set</span> dirname output = data_test-01_NED-RT</div><div class="line">    </div><div class="line"><span class="preprocessor">    # compare to exact solution</span></div><div class="line">    <span class="keyword">set</span> use exact solution = <span class="keyword">false</span></div><div class="line">end</div><div class="line"></div><div class="line"></div><div class="line">subsection Equation parameters</div><div class="line">    subsection Right-hand side</div><div class="line">        <span class="keyword">set</span> Function constants  = scale=100</div><div class="line">        </div><div class="line"><span class="preprocessor">        # This is the gradient of the H^1_0-function </span></div><div class="line"><span class="preprocessor">        # V=scale*x*y*z*(x-1)*(y-1)*(z-1)</span></div><div class="line"><span class="preprocessor">        # and hence curl(u)=0 for zero (natural) BCs</span></div><div class="line">        <span class="keyword">set</span> Function expression = scale*(2*x-1)*(y^2-y)*(z^2-z); scale*(2*y-1)*(x^2-x)*(z^2-z); scale*(2*z-1)*(x^2-x)*(y^2-y)       </div><div class="line">    </div><div class="line">        # The name of the variables as they will be used in the <span class="keyword">function</span>, separated</div><div class="line">        # by <span class="charliteral">&#39;,&#39;</span>.</div><div class="line">        <span class="keyword">set</span> Variable names      = x,y,z</div><div class="line">    end</div><div class="line">    </div><div class="line">    # Note that the exact solution is only there </div><div class="line">    # to verify the standard method</div><div class="line">    subsection Exact solution</div><div class="line">        # The manufactured exact solution is just a linear </div><div class="line">        # <span class="keyword">function</span> u=Ax+b.</div><div class="line">        # The right hand side is computed automatically</div><div class="line">        </div><div class="line">        # Here the matrix values of A</div><div class="line">        <span class="keyword">set</span> a_00 = 1</div><div class="line">        <span class="keyword">set</span> a_01 = 1</div><div class="line">        <span class="keyword">set</span> a_02 = 0</div><div class="line">        </div><div class="line">        <span class="keyword">set</span> a_10 = 0.5</div><div class="line">        <span class="keyword">set</span> a_11 = 2</div><div class="line">        <span class="keyword">set</span> a_12 = -1</div><div class="line">        </div><div class="line">        <span class="keyword">set</span> a_20 = 0</div><div class="line">        <span class="keyword">set</span> a_21 = -1</div><div class="line">        <span class="keyword">set</span> a_22 = -1</div><div class="line">        </div><div class="line">        # Here the vector values of b</div><div class="line">        <span class="keyword">set</span> b_0 = 1</div><div class="line">        <span class="keyword">set</span> b_1 = 1</div><div class="line">        <span class="keyword">set</span> b_2 = 1     </div><div class="line">    end</div><div class="line">    </div><div class="line">    subsection Diffusion A</div><div class="line">        <span class="keyword">set</span> frequency x = 17</div><div class="line">        <span class="keyword">set</span> frequency y = 16</div><div class="line">        <span class="keyword">set</span> frequency z = 15</div><div class="line">        </div><div class="line">        # scaling parameter</div><div class="line">        <span class="keyword">set</span> scale x = 1.0</div><div class="line">        <span class="keyword">set</span> scale y = 1.0</div><div class="line">        <span class="keyword">set</span> scale z = 1.0</div><div class="line">        </div><div class="line">        # scaling parameter to <span class="keyword">set</span> the contrast</div><div class="line">        <span class="keyword">set</span> alpha x = 0.9</div><div class="line">        <span class="keyword">set</span> alpha y = 0.9</div><div class="line">        <span class="keyword">set</span> alpha z = 0.9</div><div class="line">        </div><div class="line">        # Rotate with fixed Euler angles</div><div class="line">        <span class="keyword">set</span> rotate = <span class="keyword">true</span></div><div class="line">    end</div><div class="line">    </div><div class="line">    subsection Diffusion B</div><div class="line">        <span class="keyword">set</span> frequency = 14</div><div class="line">        <span class="keyword">set</span> scale = 1</div><div class="line">        <span class="keyword">set</span> alpha = 0.9</div><div class="line">        </div><div class="line">        # Separate vector valued expressions by <span class="charliteral">&#39;;&#39;</span> as <span class="charliteral">&#39;,&#39;</span> is used internally by the</div><div class="line">        # <span class="keyword">function</span> parser.</div><div class="line">        <span class="keyword">set</span> Function expression = scale * (1.0 - alpha * sin(2*pi*frequency*x))</div><div class="line">    end</div><div class="line">end         </div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
